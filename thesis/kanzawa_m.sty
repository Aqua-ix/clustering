%
% kanzawa_m.sty
%  kanzawa.sty, ekanzawa.sty の共通部分
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 
%  \Box を□に置き換える（大石研で何故か\Boxが使えないため）
%
% \renewcommand{\Box}{□}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  記号の定義
%
\newcommand{\Cofactor}{\mbox{\Large\rm cofactor}}
\newcommand{\cofactor}{\mbox{\normalsize\rm cofactor}}
\newcommand{\di}{\mbox{\normalsize\rm d}}
\newcommand{\tr}{\mbox{\small\rm tr}}
\newcommand{\Z}{\mbox{\boldmath $Z$}}           % Z
\newcommand{\N}{\mbox{\boldmath $N$}}		% N
\newcommand{\Q}{\mbox{\boldmath $Q$}}		% 有理数の集合Q
\newcommand{\R}{\mbox{\boldmath $R$}}		% ユークリッド空間R
\newcommand{\Rn}{\mbox{\boldmath $R$}^n}	% n次元ユークリッド空間Rn
\newcommand{\Rm}{\mbox{\boldmath $R$}^m}	% m次元ユークリッド空間Rm
\newcommand{\Rl}{\mbox{\boldmath $R$}^l}	% l次元ユークリッド空間Rl
\newcommand{\Rnu}{\mbox{\boldmath $R$}^{\nu}}    %
\newcommand{\Rmu}{\mbox{\boldmath $R$}^{\mu}}    %
\newcommand{\Rmn}{\mbox{\boldmath $R$}^{m+n}}	% m+n次元ユークリッド空間Rm+n
\newcommand{\C}{\mbox{\boldmath $C$}}		% 複素空間C
\newcommand{\K}{\mbox{\boldmath $K$}}		% 実数空間＋複素空間K
\newcommand{\Dbar}{\overline{D}}			% Closure of D
%\newcommand{\qed}{\hspace*{\fill} \mbox{□}}	% □ 改行無し
\newcommand{\qednl}{\hspace*{\fill} \mbox{□} \\}		% □ 改段
\newcommand{\inb}{\mbox{$\; \in_\beta \;$}}		% \in + 下付き\beta
\newcommand{\ing}{\mbox{$\; \in_\gamma \;$}}	% \in + 下付き\gamma
\newcommand{\rank}{\mbox rank}
\newcommand{\range}{\mbox Range}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  演算子の定義（\nolimitsで上下限が上下につくのを禁止）
%
\newcommand{\codim}{\mathop{\rm codim} \nolimits}	% codim
\newcommand{\ind}{\mathop{\rm ind} \nolimits}		% ind
\newcommand{\supp}{\mathop{\rm supp}}				% supp
\newcommand{\Mid}{\mathop{\rm mid} \nolimits}		% mid
\newcommand{\Rad}{\mathop{\rm rad} \nolimits}		% rad
\newcommand{\bis}{\mathop{\rm bis} \nolimits}           % bis
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  (1) 定理環境で文字をイタリックに変えないようにする．
%  (2) 最後に\Boxを付加．
%
% \def\@begintheorem#1#2{\it \trivlist \item[\hskip \labelsep\textbf{#1\ #2}]}
\def\@begintheorem#1#2{\trivlist \item[\hskip \labelsep\textbf{#1\ #2}]}
\def\@opargbegintheorem#1#2#3{\trivlist
      \item[\hskip \labelsep\textbf{#1\ #2\ (#3)}]}
% \def\@endtheorem{\endtrivlist}
\def\@endtheorem{\hspace*{\fill} □ \endtrivlist}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%   LaTeX の不具合の修正（from LaTeX美文書作成入門pp.188-189）
%
% \sloppy の修正(10000→9999)
%
\def\sloppy{\tolerance=9999 \hfuzz=.5\p@ \vfuzz=.5\p@}
%
% \eqnarray の修正
% (演算子の両側が空きすぎることを防ぐ修正)
%
\def\eqnarray{% &=&とした時にイコールの両側が空きすぎることを防ぐ修正
  \stepcounter{equation}%
  \let\@currentlabel=\theequation
  \global\@eqnswtrue
  \global\@eqcnt\z@
  \tabskip\@centering
  \let\\=\@eqncr
  $$\halign to \displaywidth\bgroup\@eqnsel\hskip\@centering
  $\displaystyle\tabskip\z@{##}$&\global\@eqcnt\@ne
  \hfil$\displaystyle{{}##{}}$\hfil
  &\global\@eqcnt\tw@$\displaystyle\tabskip\z@{##}$\hfil
  \tabskip\@centering&\llap{##}\tabskip\z@\cr}
%
% \oval の修正
% (横幅，縦幅の小さいほうが4ptの倍数より少し小さいときのbug修正)
%
\def\@oval(#1,#2)[#3]{\begingroup\boxmaxdepth \maxdimen
  \@ovttrue \@ovbtrue \@ovltrue \@ovrtrue
  \@tfor\@tempa :=#3\do{\csname @ov\@tempa false\endcsname}\@ovxx
  #1\unitlength \@ovyy #2\unitlength
  \@tempdimb \ifdim \@ovyy >\@ovxx \@ovxx\else \@ovyy \fi
  \@getcirc \@tempdimb
  \@ovro \ht\@tempboxa \@ovri \dp\@tempboxa
  \@ovdx\@ovxx \advance\@ovdx -\@tempdima \divide\@ovdx \tw@
  \@ovdy\@ovyy \advance\@ovdy -\@tempdima \divide\@ovdy \tw@
  \@circlefnt \setbox\@tempboxa
  \hbox{\if@ovr \@ovvert32\kern -\@tempdima \fi
  \if@ovl \kern \@ovxx \@ovvert01\kern -\@tempdima \kern -\@ovxx \fi
  \if@ovt \@ovhorz \kern -\@ovxx \fi
  \if@ovb \raise \@ovyy \@ovhorz \fi}\advance\@ovdx\@ovro
  \advance\@ovdy\@ovro \ht\@tempboxa\z@ \dp\@tempboxa\z@
  \@put{-\@ovdx}{-\@ovdy}{\box\@tempboxa}%
  \endgroup}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%    \approxで≒を表示できるように
%    \leqで≧，\geqで≦を表示できるようにする
%
\def\approx{\mathrel{\mathpalette\ap@align{\smash.}}}
\def\ap@align#1#2{\lower.2ex\vbox{\baselineskip\z@skip\lineskip\z@
    \def\finsm@sh{\ht\z@.2ex \dp\z@.2ex \box\z@}
    \ialign{$\m@th#1\hfil##\hfil$\crcr#2\crcr=\crcr#2\crcr}}}
\def\leq{\mathrel{\mathpalette\gl@align<}}
\def\geq{\mathrel{\mathpalette\gl@align>}}
\def\gl@align#1#2{\lower.6ex\vbox{\baselineskip\z@skip\lineskip\z@
    \ialign{$\m@th#1\hfil##\hfil$\crcr#2\crcr=\crcr}}}
%
%    本来の\approx，\leq，\geqをそれぞれ\APPROX，\LEQ，\GEQとして登録
%
\mathchardef\APPROX="3219
\mathchardef\LEQ="3214 \let\LE=\LEQ
\mathchardef\GEQ="3215 \let\GE=\GEQ
%
%   \FRACで分数を1/4のように表示する
%
\def\FRAC#1#2{\leavevmode\kern-.1em
  \raise.5ex\hbox{\the\scriptfont0 #1}\kern-.1em
  /\kern-.15em\lower.25ex\hbox{\the\scriptfont0 #2}}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%\の再定義(Yと=の重ね打ちに)
%
\def\yen{Y\llap=}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%   \verb, \verb*, verbatim, verbatim*で¥が＼になることの修正
%
\begingroup
  \catcode`\|=0   \catcode`\\=13
  |gdef|verbh@@k{|catcode`|\=13 |let\=|yen}
|endgroup

\def\verb{\begingroup \catcode``=13 \@noligs
  \tt \let\do\@makeother \dospecials \verbh@@k
  \@ifstar{\@sverb}{\@verb}}

\begingroup
  \catcode `|=0     \catcode `[= 1     \catcode`]=2%
  \catcode `\{=12   \catcode `\}=12    \catcode`\\=13
  |gdef|@xverbatim#1\end{verbatim}[#1|end[verbatim]]
  |gdef|@sxverbatim#1\end{verbatim*}[#1|end[verbatim*]]
|endgroup

\newdimen\verbatimleftmargin \verbatimleftmargin=\leftmargini
\newdimen\verbatimbaselineskip \verbatimbaselineskip=11pt
\def\verbatimsize{\small}

\def\@verbatim{%
  \trivlist \item[]%
  \if@minipage \else
    \vskip\baselineskip
    \vskip-\verbatimbaselineskip
    \vskip\parskip
  \fi
  \leftskip=\@totalleftmargin
  \if@minipage \else
    \advance \leftskip by \verbatimleftmargin
  \fi
  \rightskip=\z@  \parindent=\z@
  \parfillskip=\@flushglue  \parskip=\z@
  \@tempswafalse
  \def\par{%
    \if@tempswa\hbox{}\fi
    \@tempswatrue
    \@@par}%
  \obeylines
  \verbatimsize \baselineskip=\verbatimbaselineskip \tt
  \catcode``=13 \@noligs \let\do\@makeother \dospecials}

\def\verbatim{\@verbatim \frenchspacing \@vobeyspaces \verbh@@k \@xverbatim}

\@namedef{verbatim*}{\@verbatim \verbh@@k \@sxverbatim}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%リターンキー記号の定義(\returnで使用可)
%
\def\return{\raisebox{-2pt}{%   以下を2ポイント下げる
  \setlength{\unitlength}{1pt}% 単位はポイント
  \thinlines %                  細い線で
  \ifx\@currsize\small %        もし\smallなら
    \begin{picture}(13,8)
      \put(10,3){\line(0,1){5}}
      \put(10,3){\vector(-1,0){7}}
      \put(1,2){\line(0,1){6}}
      \put(12,2){\line(0,1){6}}
      \put(6.5,8){\oval(11,4)[t]}
      \put(6.5,2){\oval(11,4)[b]}
    \end{picture}%
  \else %                       そうでないなら
    \begin{picture}(14,9)
      \put(11,3){\line(0,1){6}}
      \put(11,3){\vector(-1,0){8}}
      \put(1,2){\line(0,1){7}}
      \put(13,2){\line(0,1){7}}
      \put(7,9){\oval(12,4)[t]}
      \put(7,2){\oval(12,4)[b]}
    \end{picture}%
  \fi %                         ifの終わり
}}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  丸数字を\MARU{数字}で表示できるようにする(ただし，数字は1桁)
%
\def\MARU#1{{\rm\ooalign{\hfil\lower.168ex\hbox{#1}\hfil
  \crcr\mathhexbox20D}}}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%	`bigmath.sty'---Variable Size Math Expression
%	Author: Katsuya (NIFTY-Serve ID: JCA00315)
%   \typeout{Document Style Option `bigmath' Version 0.00  (March 2nd, 1993)}
%
%   数式 (の記号部) を \normalsize〜\Huge の範囲でサイズ変更にする
%
% 11pt
\let\@bmath@xipt=\xipt
\def\xipt{\@bmath@xipt
\@ifundefined{elvex}{\global\font\elvex=cmex10\@halfmag}{}
\textfont\thr@@\elvex \scriptfont\thr@@\elvex \scriptscriptfont\thr@@\elvex}

% 12pt
\let\@bmath@xiipt=\xiipt
\def\xiipt{\@bmath@xiipt
\@ifundefined{twlex}{\global\font\twlex=cmex10\@magscale1}{}
\textfont\thr@@\twlex \scriptfont\thr@@\twlex \scriptscriptfont\thr@@\twlex}

% 14pt
\let\@bmath@xivpt=\xivpt
\def\xivpt{\@bmath@xivpt
\@ifundefined{frtnex}{\global\font\frtnex=cmex10\@magscale2}{}
\textfont\thr@@\frtnex \scriptfont\thr@@\frtnex \scriptscriptfont\thr@@\frtnex}

% 17pt
\let\@bmath@xviipt=\xviipt
\def\xviipt{\@bmath@xviipt
\@ifundefined{svtnex}{\global\font\svtnex=cmex10\@magscale3}{}
\textfont\thr@@\svtnex \scriptfont\thr@@\svtnex \scriptscriptfont\thr@@\svtnex}

% 20pt
\let\@bmath@xxpt=\xxpt
\def\xxpt{\@bmath@xxpt
\@ifundefined{twtyex}{\global\font\twtyex=cmex10\@magscale4}{}
\textfont\thr@@\twtyex \scriptfont\thr@@\twtyex \scriptscriptfont\thr@@\twtyex}

% 25pt
\let\@bmath@xxvpt=\xxvpt
\def\xxvpt{\@bmath@xxvpt
\@ifundefined{twfvex}{\global\font\twfvex=cmex10\@magscale5}{}
\textfont\thr@@\twfvex \scriptfont\thr@@\twfvex \scriptscriptfont\thr@@\twfvex}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%	`sfb.sty'---Sans-Serif Face Bold
%	Author: Katsuya (NIFTY-Serve ID: JCA00315)
%   \typeout{Document Style Option `sfb' Version 0.00  (March 2nd, 1993)}
%
%   cmssbx10  (Sans  Serif Bold  Extended) を \sfb というコントロールワードで
%   \rm や \sf などと同様に使用できるようにする
%
\def\@mssbx{cmssbx10}

\def\sfb{\protect\psfb}

\@ifundefined{sfbfam}{\newfam\sfbfam}{}


% 5pt
\let\@sfb@vpt=\vpt
\def\vpt{\@sfb@vpt
	\def\psfb{\@subfont\sfb\rm}}

% 6pt
\let\@sfb@vipt=\vipt
\def\vipt{\@sfb@vipt
	\def\psfb{\@subfont\sfb\rm}}

% 7pt
\let\@sfb@viipt=\viipt
\def\viipt{\@sfb@viipt
	\def\psfb{\@subfont\sfb\rm}}

% 8pt
\let\@sfb@viiipt=\viiipt
\def\viiipt{\@sfb@viiipt
	\def\psfb{\@subfont\sfb\sf}}

% 9pt
\let\@sfb@ixpt=\ixpt
\def\ixpt{\@sfb@ixpt
	\def\psfb{\@subfont\sfb\sf}}

% 10pt
\let\@sfb@xpt=\xpt
\def\xpt{\@sfb@xpt
\def\psfb{\@getfont\psfb\sfbfam\@xpt{\@mssbx}}}

% 11pt
\let\@sfb@xipt=\xipt
\def\xipt{\@sfb@xipt
\def\psfb{\@getfont\psfb\sfbfam\@xipt{\@mssbx\@halfmag}}}

% 12pt
\let\@sfb@xiipt=\xiipt
\def\xiipt{\@sfb@xiipt
\def\psfb{\@getfont\psfb\sfbfam\@xiipt{\@mssbx\@magscale1}}}

% 14pt
\let\@sfb@xivpt=\xivpt
\def\xivpt{\@sfb@xivpt
\def\psfb{\@getfont\psfb\sfbfam\@xivpt{\@mssbx\@magscale2}}}

% 17pt
\let\@sfb@xviipt=\xviipt
\def\xviipt{\@sfb@xviipt
\def\psfb{\@getfont\psfb\sfbfam\@xviipt{\@mssbx\@magscale3}}}

% 20pt
\let\@sfb@xxpt=\xxpt
\def\xxpt{\@sfb@xxpt
\def\psfb{\@getfont\psfb\sfbfam\@xxpt{\@mssbx\@magscale4}}}

% 25pt
\let\@sfb@xxvpt=\xxvpt
\def\xxvpt{\@sfb@xxvpt
\def\psfb{\@getfont\psfb\sfbfam\@xxvpt{\@mssbx\@magscale5}}}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%   figmn.sty: figures arrangement for m-row and n-column by T.Keishi
%
%   ver.1.0 <Jan. 25, 1993> initial version
%
%
%  ----------------------------------------------------------------------------
%    usage: \figmn[N]{m}{n}{fig}
%                  m: number of row
%                  n: number of column
%                fig: fixed part character of file name that saved figure data
%                    (case of abc1.tex, abc2.tex, ---, abcN.tex: abc)
%
%                  N: number of figure, option parameter, default: N=m*n
%
%           Fig.1, Fig.2, ---, Fig.N must be contained in files:
%                                           abc1.tex, abc2.tex, ---, abcN.tex
%
%  ----------------------------------------------------------------------------
%   図を m行 n列配置するスタイルファイル
%
%   使い方: \figmn[N]{m}{n}{fig}
%                  m: 行数
%                  n: 列数
%                fig: 図の入ったファイルの名前の最初の部分の文字列
%                     abc1.tex, abc2.tex, ---, abcN.tex の場合は abc
%                     ~~~       ~~~            ~~~
%                  N: 図の数(オプション) 省略すると、N=m*n
%
%           Fig.1, Fig.2, ---, Fig.N は
%           個別のファイル(abc1.tex, abc2.tex, ---, abcN.tex)に作成しておく
%  ----------------------------------------------------------------------------
%
%   例(example): 下図の場合 m=3, n=2
%
%       → n                         fig. no.   file name(figure data saved)
%      ♢♢♢♢♢♢♢♢♢♢♢♢  --------  ----------
%    ↓♣ ♢♢♢  ♢♢♢ ♣    Fig.1    abc1.tex
%    m ♣ ♣      ♣  ♣      ♣ ♣
%      ♣ ♣Fig.1 ♣  ♣Fig.2 ♣ ♣    Fig.2    abc2.tex
%      ♣ ♣      ♣  ♣      ♣ ♣
%      ♣ ♢♢♢  ♢♢♢ ♣    Fig.3    abc3.tex
%      ♣                        ♣
%      ♣ ♢♢♢  ♢♢♢ ♣    Fig.4    abc4.tex
%      ♣ ♣      ♣  ♣      ♣ ♣
%      ♣ ♣Fig.3 ♣  ♣Fig.4 ♣ ♣    Fig.5    abc5.tex
%      ♣ ♣      ♣  ♣      ♣ ♣
%      ♣ ♢♢♢  ♢♢♢ ♣    Fig.6    abc6.tex
%      ♣                        ♣
%      ♣ ♢♢♢  ♢♢♢ ♣
%      ♣ ♣      ♣  ♣      ♣ ♣
%      ♣ ♣Fig.5 ♣  ♣Fig.6 ♣ ♣
%      ♣ ♣      ♣  ♣      ♣ ♣
%      ♣ ♢♢♢  ♢♢♢ ♣
%      ♣                        ♣
%      ♣                        ♣
%      ♢♢♢♢♢♢♢♢♢♢♢♢
%
%  ----------------------------------------------------------------------------
\newcounter{linenofig}       % 行数のカウンタ(1, 2, ----, m)
\newcounter{nofig}           % 図面番号のカウンタ(1, 2, ----, N) N: m*n
\newcount\ntotalfig          % 全図面数

\long\def\figmn{%
\@ifnextchar\bgroup{\figmnfull[0]}{\figmnfull}}

\def\figmnfull[#1]#2#3#4{%

\typeout{Document Style  figmn.sty  ver.1.0 <Jan. 25, 1993>}
\ifnum#2>0 % m<=0 のときはエラーメッセージを表示して終了する
\ifnum#3>0 % n<=0 のときはエラーメッセージを表示して終了する
\ifnum#3<4 % n>=4 のときはエラーメッセージを表示して終了する
\ifnum#1>-1 % N<0 のときはエラーメッセージを表示して終了する
\ntotalfig=#2
\multiply \ntotalfig by #3
\advance \ntotalfig by 1
\ifnum#1<\ntotalfig % N>m*n のときはエラーメッセージを表示して終了する
%------------------------(n<=3 のとき)------------------------------
\typeout{ number of row(=m)=#2, number of column(=n)=#3}
\ifnum#1=0
  \ntotalfig=#2
  \multiply \ntotalfig by #3
  \typeout{ number of total figure(=m*n)=\the\ntotalfig}
\else
  \ntotalfig=#1
  \typeout{ number of total figure(=given)=\the\ntotalfig}
\fi

\def\@infil{#4} % 図の入ったファイルの名前の最初の部分の文字列のセット

\setcounter{linenofig}{1}    % 行数のカウンタの初期値設定
\setcounter{nofig}{0}        % 図面番号のカウンタの初期値設定
%
%=================== n=1(1列) の場合 ===================== 1図面／行
\ifnum#3=1
  \loop
    \ifnum\thenofig<\ntotalfig
      \stepcounter{nofig}
      \begin{minipage}[t]{\textwidth}
        \hfil
        \input \@infil\thenofig\relax    % figure
        \hfil
      \end{minipage}
    \fi
  \ifnum#2>\thelinenofig  \stepcounter{linenofig}  \repeat
%
%=================== n=2(2列) の場合 ===================== 2図面／行
\else \ifnum#3=2
        \loop
          \begin{minipage}[t]{\textwidth}
            \ifnum\thenofig<\ntotalfig
              \stepcounter{nofig}
              \input \@infil\thenofig\relax    % left side figure
            \fi
            \hfil%
            \ifnum\thenofig<\ntotalfig
              \stepcounter{nofig}
              \input \@infil\thenofig\relax    % right side figure
            \fi
          \end{minipage}
        \ifnum#2>\thelinenofig  \stepcounter{linenofig}  \repeat
%
%=================== n=3(3列) の場合 ===================== 3図面／行
      \else \ifnum#3=3
              \loop
                \begin{minipage}[t]{\textwidth}
                  \ifnum\thenofig<\ntotalfig
                    \stepcounter{nofig}
                    \input \@infil\thenofig\relax    % left side figure
                  \fi
                  \hfil%
                  \ifnum\thenofig<\ntotalfig
                    \stepcounter{nofig}
                    \input \@infil\thenofig\relax    % center figure
                  \fi
                  \hfil%
                  \ifnum\thenofig<\ntotalfig
                    \stepcounter{nofig}
                    \input \@infil\thenofig\relax    % right side figure
                  \fi
                \end{minipage}
              \ifnum#2>\thelinenofig  \stepcounter{linenofig}  \repeat
            \fi
      \fi
\fi
%------------------------(N>m*n のとき)------------------------------
\else 
  \typeout{N must be less than equal m*n (N<=m*n).}
\fi
%------------------------(N<0 のとき)------------------------------
\else 
  \typeout{N must be greater than equal 0 (N>=0).}
\fi
%------------------------(n>=4 のとき)------------------------------
\else 
  \typeout{n must be less than equal 3 (n<=3). sorry!}
\fi
%------------------------(n<=0 のとき)------------------------------
\else 
  \typeout{n must be greater than equal 0 (n>=0).}
\fi
%------------------------(m<=0 のとき)------------------------------
\else 
  \typeout{m must be greater than equal 0 (m>=0).}
\fi

}
